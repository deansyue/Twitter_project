(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48c6f43a"],{be6c:function(t,e,s){"use strict";var a=s("2fa3");const i=()=>localStorage.getItem("token");e["a"]={adminSignIn({account:t,password:e}){return a["b"].post("api/admin/signin",{account:t,password:e})},deleteTweet({tweetId:t}){return a["b"].delete("api/admin/tweets/"+t,{headers:{Authorization:"Bearer "+i()}})},getAdminUsers(){return a["b"].get("api/admin/users",{headers:{Authorization:"Bearer "+i()}})}}},fa6a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-double-column"},[s("div",{staticClass:"left-container"},[s("AdminNavBar")],1),s("div",{staticClass:"middle-container"},[t._m(0),t.isLoading?s("img",{staticClass:"spinner"}):t._l(t.tweetCards,(function(e){return s("div",{key:e.id,staticClass:"main-tweets"},[s("AdminFeedList",{attrs:{"tweet-card":e},on:{"after-delete":t.afterDelete}})],1)}))],2)])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-wrapper"},[s("h3",{staticClass:"main-title"},[t._v("推文清單")])])}],r=(s("d9e2"),s("fc06")),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweetCard-wrapper"},[s("div",{staticClass:"card-left avatar"},[s("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.tweetUser.avatar)}})]),s("div",{staticClass:"card-right"},[s("div",{staticClass:"card-head"},[s("h5",{staticClass:"card-name"},[t._v(" "+t._s(t.tweetUser.name)+" ")]),s("h5",{staticClass:"card-account"},[t._v(" "+t._s(t._f("accountTag")(t.tweetUser.account))+" ")]),s("span",[t._v("．")]),s("h5",{staticClass:"card-time"},[t._v(" "+t._s(t._f("fromNow")(t.createdAt))+" ")]),s("div",{staticClass:"card-cancel"},[s("img",{staticClass:"cross-grey",on:{click:function(e){return t.deleteCard(t.id)}}})])]),s("div",{staticClass:"card-description"},[t._v(" "+t._s(t._f("wordLimit")(t.description))+" ")])])])},c=[],d=s("be6c"),o=s("2fa3"),l=s("2708"),u={mixins:[l["c"],l["a"],l["b"]],props:{tweetCard:{type:Object,required:!0}},data(){return{id:0,tweetUser:{},description:"",createdAt:"",isProcessing:!1}},methods:{fetchTweetCard(){const{User:t,description:e,id:s,createdAt:a}=this.tweetCard;this.id=s,this.tweetUser=t,this.description=e,this.createdAt=a},async deleteCard(t){try{this.isProcessing=!0;const{data:e,statusText:s}=await d["a"].deleteTweet({tweetId:t});if(this.isProcessing=!1,"OK"!==s)throw new Error(e);o["a"].fire({icon:"success",title:e.message}),this.$emit("after-delete",t)}catch(e){o["a"].fire({icon:"error",title:"無法刪除貼文，請稍後再試"})}}},created(){this.fetchTweetCard()},filters:{wordLimit(t){return t.length>50?t.substring(0,49)+"...":t}}},m=u,h=s("2877"),C=Object(h["a"])(m,n,c,!1,null,null,null),w=C.exports,f=s("6783"),v={components:{AdminNavBar:r["a"],AdminFeedList:w},data(){return{tweetCards:[],isLoading:!1,isProcessing:!1}},methods:{async fetchTweetCards(){try{this.isLoading=!0;const{data:t,statusText:e}=await f["a"].getAllTweets();if(this.isLoading=!1,"OK"!==e)throw new Error(e);this.tweetCards=[...t]}catch(t){this.isLoading=!0,o["a"].fire({icon:"error",title:"無法取得主頁資料，請稍後再試"})}},afterDelete(t){this.tweetCards=this.tweetCards.filter(e=>e.id!==t)}},created(){this.fetchTweetCards()}},g=v,p=Object(h["a"])(g,a,i,!1,null,null,null);e["default"]=p.exports},fc06:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"navBar-wrapper"},[s("div",{staticClass:"container"},[s("div",{staticClass:"logoContainer"},[s("router-link",{attrs:{to:"/admin/tweets"}},[s("img",{staticClass:"logo",attrs:{alt:"admin/tweets"}})])],1),s("div",{staticClass:"content"},[s("div",{staticClass:"homeTab"},[s("router-link",{staticClass:"navItem",attrs:{to:"/admin/tweets"}},[s("div",{staticClass:"icon"},[s("img",{staticClass:"home",attrs:{alt:""}})]),t._v(" 推文清單 ")])],1),s("div",{staticClass:"selfTab"},[s("router-link",{staticClass:"navItem",attrs:{to:"/admin/users"}},[s("div",{staticClass:"icon"},[s("img",{staticClass:"person",attrs:{alt:""}})]),t._v(" 使用者清單 ")])],1)]),s("div",{staticClass:"logoutTab"},[s("button",{staticClass:"logoutButton",on:{click:function(e){return t.logout()}}},[t._m(0),t._v(" 登出 ")])])])])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"icon"},[s("img",{staticClass:"logout",attrs:{alt:""}})])}],r=s("2f62"),n={computed:{...Object(r["b"])(["isAuthenticated"])},methods:{logout(){this.$store.commit("revokeAuthentication"),this.$router.push("/admin/signin")}}},c=n,d=s("2877"),o=Object(d["a"])(c,a,i,!1,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=chunk-48c6f43a.7786ca69.js.map