(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-88f9bd48"],{"4cce":function(s,e,t){"use strict";var r=t("2fa3");const a=()=>localStorage.getItem("token");e["a"]={getUser({userId:s}){return r["b"].get("api/users/"+s,{headers:{Authorization:"Bearer "+a()}})},getUserTweets({userId:s}){return r["b"].get(`api/users/${s}/tweets`,{headers:{Authorization:"Bearer "+a()}})},getUserReplies({userId:s}){return r["b"].get(`api/users/${s}/replied_tweets`,{headers:{Authorization:"Bearer "+a()}})},getUserLikes({userId:s}){return r["b"].get(`api/users/${s}/likes`,{headers:{Authorization:"Bearer "+a()}})},getFollowers({userId:s}){return r["b"].get(`api/users/${s}/followers`,{headers:{Authorization:"Bearer "+a()}})},getFollowings({userId:s}){return r["b"].get(`api/users/${s}/followings`,{headers:{Authorization:"Bearer "+a()}})},editInformation({id:s,formData:e}){return r["b"].put("api/users/"+s,e,{headers:{Authorization:"Bearer "+a()}})},signEdit({userId:s,account:e,name:t,email:o,password:i,checkPassword:l}){return r["b"].put(`api/users/${s}/edit`,{account:e,name:t,email:o,password:i,checkPassword:l},{headers:{Authorization:"Bearer "+a()}})},addFollow({id:s}){return r["b"].post("/api/followships",{id:s},{headers:{Authorization:"Bearer "+a()}})},deleteFollow({followingId:s}){return r["b"].delete("api/followships/"+s,{headers:{Authorization:"Bearer "+a()}})},getTopUser(){return r["b"].get("api/users/top",{headers:{Authorization:"Bearer "+a()}})}}},"5b5f":function(s,e,t){"use strict";t.r(e);var r=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"followship-wrapper"},[t("ul",{staticClass:"followship-tabs"},[t("li",{staticClass:"followship-tab"},[t("router-link",{attrs:{to:{name:"followers",params:{id:s.paramsId}}}},[s._v(" 追隨者 ")])],1),t("li",{staticClass:"followship-tab"},[t("router-link",{attrs:{to:{name:"followings",params:{id:s.paramsId}}}},[s._v(" 正在追隨 ")])],1)]),s.isLoading?t("img",{staticClass:"spinner"}):s._l(s.followCards,(function(e){return t("div",{key:e.id,staticClass:"userFollowCards"},[t("div",{staticClass:"userFollowCards-left avatar"},[t("img",{staticClass:"avatar",attrs:{src:s._f("emptyImage")(e.avatar)}})]),t("div",{staticClass:"userFollowCards-right"},[e.isFollowed?t("button",{directives:[{name:"show",rawName:"v-show",value:s.currentUser.id!==e.followingId,expression:"currentUser.id !== followCard.followingId"}],staticClass:"btn active",attrs:{disabled:s.isProcessing},on:{click:function(t){return s.deleteFollow(e.followingId)}}},[s._v("正在跟隨")]):t("button",{directives:[{name:"show",rawName:"v-show",value:s.currentUser.id!==e.followingId,expression:"currentUser.id !== followCard.followingId"}],staticClass:"btn",attrs:{disabled:s.isProcessing},on:{click:function(t){return s.addFollow(e.followingId)}}},[s._v("跟隨")]),t("h5",{staticClass:"name"},[s._v(s._s(e.name))]),t("h5",{staticClass:"account"},[s._v(s._s(s._f("accountTag")(e.account)))]),t("p",[s._v(s._s(e.introduction))])])])}))],2)},a=[],o=(t("d9e2"),t("4cce")),i=t("2f62"),l=t("2fa3"),n=t("2708"),d={mixins:[n["a"],n["b"]],computed:{...Object(i["b"])(["currentUser"])},data(){return{paramsId:0,followCards:[],isLoading:!1,isProcessing:!1}},methods:{async fetchFollowCard(s){try{this.isLoading=!0;const{statusText:e,data:t}=await o["a"].getFollowings({userId:s});if(this.isLoading=!1,"OK"!==e)throw new Error;this.followCards=[...t]}catch(e){this.isLoading=!1,l["a"].fire({icon:"error",title:e.message})}},async addFollow(s){try{this.isProcessing=!0;const{data:e}=await o["a"].addFollow({id:s});if(this.isProcessing=!1,"success"!==e.status)throw new Error;l["a"].fire({icon:"success",title:e.message}),this.followCards=this.followCards.map(e=>e.followingId!==s?e:{...e,isFollowed:!0})}catch(e){this.isProcessing=!1,l["a"].fire({icon:"error",title:e.message})}},async deleteFollow(s){try{this.isProcessing=!0;const{data:e}=await o["a"].deleteFollow({followingId:s});if("success"!==e.status)throw new Error;this.isProcessing=!1,l["a"].fire({icon:"success",title:e.message}),this.followCards=this.followCards.map(e=>e.followingId!==s?e:{...e,isFollowed:!1})}catch(e){this.isProcessing=!1,l["a"].fire({icon:"error",title:"無法進行追蹤，請稍後再試"})}}},created(){const{id:s}=this.$route.params;this.paramsId=Number(s),this.fetchFollowCard(this.paramsId)},beforeRouteUpdate(){const{id:s}=this.$route.params;this.paramsId=Number(s),this.fetchFollowCard(this.paramsId)}},c=d,u=t("2877"),w=Object(u["a"])(c,r,a,!1,null,null,null);e["default"]=w.exports}}]);
//# sourceMappingURL=chunk-88f9bd48.e3055bf8.js.map