(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0db236"],{"6f1a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.isLoading?r("img",{staticClass:"spinner"}):r("div",[r("div",{staticClass:"tweet-wrapper"},[r("div",{staticClass:"tweet-title"},[r("img",{staticClass:"arrow",on:{click:function(t){return e.$router.back()}}}),r("h3",[e._v("推文")])]),r("div",{staticClass:"tweet-main"},[r("div",{staticClass:"card-head"},[r("div",{staticClass:"card-head-left avatar",on:{click:function(t){return e.linkedUser(e.user.id)}}},[r("img",{staticClass:"avatar",attrs:{src:e._f("emptyImage")(e.user.avatar)}})]),r("div",{staticClass:"card-head-right"},[r("h5",{on:{click:function(t){return e.linkedUser(e.user.id)}}},[e._v(e._s(e.user.name))]),r("h5",[e._v(e._s(e._f("accountTag")(e.user.account)))])])]),r("div",{staticClass:"tweet-body"},[r("p",[e._v(e._s(e.repliedTweet.description))]),r("h5",[e._v(e._s(e._f("timeFormat")(e.repliedTweet.createdAt)))])]),r("div",{staticClass:"tweet-footer"},[r("div",{staticClass:"tweet-footer-info"},[r("h4",[r("strong",[e._v(e._s(e.replyCards.length))]),e._v(" 回覆 ")]),r("h4",[r("strong",[e._v(e._s(e.repliedTweet.likeCount))]),e._v(" 喜歡次數 ")])]),r("div",{staticClass:"tweet-footer-buttons"},[r("img",{staticClass:"reply-big",on:{click:function(t){return e.showReplyModal()}}}),e.repliedTweet.isLiked?r("img",{staticClass:"heart-big-active",on:{click:function(t){return e.deleteLike()}}}):r("img",{staticClass:"heart-big",on:{click:function(t){return e.addLike()}}})])])])]),e._l(e.replyCards,(function(t){return r("div",{key:t.id,staticClass:"tweet-replies"},[r("TweetReplyCard",{attrs:{"reply-target":e.user,"reply-card":t}})],1)}))],2)])},s=[],i=r("2909"),n=r("1da1"),c=r("5530"),d=(r("96cf"),r("d9e2"),r("b0c0"),r("a4d3"),r("e01a"),r("a9e3"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tweetReplyCard-wrapper"},[r("div",{staticClass:"card-left avatar",on:{click:function(t){return e.linkedUser(e.userId)}}},[r("img",{staticClass:"avatar",attrs:{src:e._f("emptyImage")(e.avatar)}})]),r("div",{staticClass:"card-right"},[r("div",{staticClass:"card-head"},[r("h5",{staticClass:"card-name",on:{click:function(t){return e.linkedUser(e.userId)}}},[e._v(" "+e._s(e.userName)+" ")]),r("h5",{staticClass:"card-account"},[e._v(" "+e._s(e._f("accountTag")(e.userAccount))+" ")]),r("span",[e._v("．")]),r("h5",{staticClass:"card-time"},[e._v(" "+e._s(e._f("fromNow")(e.createdAt))+" ")])]),r("h5",[r("span",[e._v("回覆")]),r("span",{staticClass:"card-replyer",on:{click:function(t){return e.linkedUser(e.targetUserId)}}},[e._v(" "+e._s(e._f("accountTag")(e.targetAccount))+" ")])]),r("p",[e._v(e._s(e.comment))])])])}),o=[],u=r("2708"),l=r("2f62"),p={mixins:[u["c"],u["a"],u["b"]],props:{replyTarget:{type:Object,required:!0},replyCard:{type:Object,required:!0}},data:function(){return{targetAccount:"",targetUserId:0,tweetId:0,userId:0,comment:"",createdAt:"",userName:"",userAccount:"",avatar:""}},computed:Object(c["a"])({},Object(l["b"])(["currentUser"])),methods:{fetchReplyCard:function(){this.targetAccount=this.replyTarget.account,this.targetUserId=this.replyTarget.id;var e=this.replyCard,t=e.id,r=e.comment,a=e.createdAt,s=e.UserId,i=e.User;this.tweetId=t,this.userId=s,this.comment=r,this.createdAt=a,this.userName=i.name,this.userAccount=i.account,this.avatar=i.avatar},linkedUser:function(e){e===this.currentUser.id?this.$router.push({name:"self"}):this.$router.push({name:"other",params:{id:e}})}},created:function(){this.fetchReplyCard()},watch:{replyCard:function(e){this.replyCard=e,this.fetchReplyCard()},replyTarget:function(e){this.replyTarget=e,this.fetchReplyCard()}}},h=p,f=r("2877"),m=Object(f["a"])(h,d,o,!1,null,null,null),v=m.exports,w=r("6783"),g=r("2fa3"),C={name:"Tweet",components:{TweetReplyCard:v},mixins:[u["a"],u["f"],u["b"]],computed:Object(c["a"])({},Object(l["b"])(["currentUser","replyCreate"])),data:function(){return{paramsId:0,user:{},repliedTweet:{},replyCards:[],isLoading:!1,isProcessing:!1}},methods:{fetchRepliedTweet:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,w["a"].getRepliedTweet({tweetId:e});case 4:if(a=r.sent,s=a.data,i=a.statusText,"OK"===i){r.next=9;break}throw new Error(i);case 9:t.isLoading=!1,t.user=s.User,t.repliedTweet=Object(c["a"])({},s),r.next=18;break;case 14:r.prev=14,r.t0=r["catch"](0),t.isLoading=!1,g["a"].fire({icon:"error",title:"無法取得推文內容，請稍後再試"});case 18:case"end":return r.stop()}}),r,null,[[0,14]])})))()},fetchTweetReplyCards:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,w["a"].getAllReplies({tweetId:e});case 4:if(a=r.sent,s=a.data,n=a.statusText,"OK"===n){r.next=9;break}throw new Error(n);case 9:t.isLoading=!1,t.replyCards=Object(i["a"])(s),r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](0),t.isLoading=!1,g["a"].fire({icon:"error",title:"無法取得回覆推文，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,13]])})))()},afterSubmitReplyCreate:function(e){this.replyCards.unshift({comment:e.comment,id:e.id,createdAt:e.createdAt,User:{avatar:this.currentUser.avatar,account:this.currentUser.account,name:this.currentUser.name}})},addLike:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,w["a"].addLike({tweetId:e.paramsId});case 4:if(r=t.sent,a=r.statusText,s=r.data,"OK"===a&&"success"===s.status){t.next=9;break}throw new Error(a);case 9:e.isProcessing=!1,e.repliedTweet.isLiked=!0,e.repliedTweet.likeCount++,t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),e.isProcessing=!1,g["a"].fire({icon:"error",title:"無法加入最愛，請稍後再試"});case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()},deleteLike:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,w["a"].deleteLike({tweetId:e.paramsId});case 4:if(r=t.sent,a=r.statusText,s=r.data,"OK"===a&&"success"===s.status){t.next=9;break}throw new Error(a);case 9:e.isProcessing=!1,e.repliedTweet.isLiked=!1,e.repliedTweet.likeCount--,t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),e.isProcessing=!1,g["a"].fire({icon:"error",title:"無法取消最愛，請稍後再試"});case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()},linkedUser:function(e){e===this.currentUser.id?this.$router.push({name:"self"}):this.$router.push({name:"other",params:{id:e}})},showReplyModal:function(){this.$modal.show("replyCreate");var e=this.repliedTweet,t=e.id,r=e.User,a=e.description,s=e.createdAt,i={id:t,name:r.name,userId:r.id,account:r.account,avatar:r.avatar,description:a,createdAt:s};this.$store.commit("setTweetReplyTarget",i)}},created:function(){var e=this.$route.params.id;this.paramsId=Number(e),this.fetchRepliedTweet(this.paramsId),this.fetchTweetReplyCards(this.paramsId)},beforeRouteUpdate:function(e,t,r){var a=e.params.id;this.paramsId=Number(a),this.fetchRepliedTweet(this.paramsId),this.fetchTweetReplyCards(this.paramsId),r()},watch:{replyCreate:function(e){this.afterSubmitReplyCreate(e)}}},k=C,y=Object(f["a"])(k,a,s,!1,null,null,null);t["default"]=y.exports}}]);
//# sourceMappingURL=chunk-2d0db236-legacy.9cf907b1.js.map